!function(a){var s={},e={onReady:function(){this.setupDOM(),this.eventListeners(),this.initializeDependencies()},setupDOM:function(){s.oauthConnectionOpt=a("#zoom_connection_opt_oauth"),s.oauthConnectionJwt=a("#zoom_connection_opt_jwt"),s.select2=a(".zvc-hacking-select"),s.dateTimePicker=a("#datetimepicker"),s.reportsDatePicker=a("#reports_date"),s.zoomAccountDatepicker=a(".zoom_account_datepicker"),s.dataTable=a("#zvc_users_list_table, #zvc_meetings_list_table"),s.meetingListTableCheck=a("#zvc_meetings_list_table"),s.meetingListTbl=s.meetingListTableCheck.find("input[type=checkbox]"),s.cover=a("#zvc-cover"),s.togglePwd=a(".toggle-api"),s.toggleSecret=a(".toggle-secret"),s.changeMeetingState=a(".vczapi-meeting-state-change"),s.show_on_meeting_delete_error=a(".show_on_meeting_delete_error")},eventListeners:function(){s.oauthConnectionOpt.on("click",this.showOauthRow),s.oauthConnectionJwt.on("click",this.showJwtRow),s.meetingListTableCheck.find("#checkall").on("click",this.meetingListTableCheck),a("#bulk_delete_meeting_listings").on("click",this.bulkDeleteMeetings),a(".zvc-meetings-form").find('input[name="password"]').on("keypress",this.meetingPassword),a(".delete-meeting").on("click",this.deleteMetting),s.togglePwd.on("click",this.toggleAPISettings.bind(this)),s.toggleSecret.on("click",this.toggleSecretSettings.bind(this)),a(".vanity-url-enable").on("click",this.vanityURLShow),a(".zvc-dismiss-message").on("click",this.dismissNotice.bind(this)),a(".check-api-connection").on("click",this.checkConnection.bind(this)),a(s.changeMeetingState).on("click",this.meetingStateChange.bind(this))},showOauthRow:function(){a("tr.tr-oauth").addClass("tr-oauth--show"),a("tr.tr-jwt").removeClass("tr-jwt--show")},showJwtRow:function(){a("tr.tr-jwt").addClass("tr-jwt--show"),a("tr.tr-oauth").removeClass("tr-oauth--show")},initializeDependencies:function(){0<s.select2.length&&s.select2.select2(),this.datePickers(),0<s.dataTable.length&&s.dataTable.dataTable({pageLength:25,columnDefs:[{targets:0,orderable:!1}]})},datePickers:function(){if(0<s.dateTimePicker.length){var e=new Date,t=e.getMonth()+1,i=e.getDate(),n=e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),o=e.getFullYear()+"-"+(t<10?"0":"")+t+"-"+(i<10?"0":"")+i+" "+n,c=s.dateTimePicker.data("existingdate");c&&(o=c),s.dateTimePicker.datetimepicker({value:o,step:15,minDate:0,format:"Y-m-d H:i"})}0<s.reportsDatePicker.length&&s.reportsDatePicker.datepicker({changeMonth:!0,changeYear:!1,showButtonPanel:!0,dateFormat:"MM yy"}).focus(function(){var i=a(this);a(".ui-datepicker-calendar").detach(),a(".ui-datepicker-close").click(function(){var e=a("#ui-datepicker-div .ui-datepicker-month :selected").val(),t=a("#ui-datepicker-div .ui-datepicker-year").html();i.datepicker("setDate",new Date(t,e,1))})}),0<s.zoomAccountDatepicker.length&&s.zoomAccountDatepicker.datepicker({dateFormat:"yy-mm-dd"})},meetingListTableCheck:function(){a(this).is(":checked")?s.meetingListTbl.each(function(){a(this).prop("checked",!0)}):s.meetingListTbl.each(function(){a(this).prop("checked",!1)})},bulkDeleteMeetings:function(){if(1!=confirm("Confirm bulk delete these Meeting?"))return!1;var e=[];s.meetingListTableCheck.find("input.checkthis").each(function(){a(this).is(":checked")&&e.push(a(this).val())});var t=a(this).data("hostid");if(e){var i={meetings_id:e,host_id:t,action:"zvc_bulk_meetings_delete",security:zvc_ajax.zvc_security};s.cover.show(),a.post(zvc_ajax.ajaxurl,i).done(function(e){s.cover.fadeOut("slow"),1==e.error?s.show_on_meeting_delete_error.show().html("<p>"+e.msg+"</p>"):(s.show_on_meeting_delete_error.show().html("<p>"+e.msg+"</p>"),location.reload())})}},meetingPassword:function(e){if(!/([a-zA-Z0-9])+/.test(String.fromCharCode(e.which)))return!1;var t=a(this).val(),i=a(this).data("maxlength");0<i&&a(this).val(t.substr(0,i))},deleteMetting:function(){var e=a(this).data("meetingid"),t=a(this).data("hostid");if(1!=confirm("Confirm Delete this Meeting?"))return!1;var i={meeting_id:e,host_id:t,action:"zvc_delete_meeting",security:zvc_ajax.zvc_security};s.cover.show(),a.post(zvc_ajax.ajaxurl,i).done(function(e){s.cover.fadeOut("slow"),1==e.error?s.show_on_meeting_delete_error.show().html("<p>"+e.msg+"</p>"):(s.show_on_meeting_delete_error.show().html("<p>"+e.msg+"</p>"),location.reload())})},toggleAPISettings:function(){var e=a("#zoom_api_key");"Show"===s.togglePwd.html()?(s.togglePwd.html("Hide"),e.attr("type","text")):(s.togglePwd.html("Show"),e.attr("type","password"))},toggleSecretSettings:function(){var e=a("#zoom_api_secret");"Show"===s.toggleSecret.html()?(s.toggleSecret.html("Hide"),e.attr("type","text")):(s.toggleSecret.html("Show"),e.attr("type","password"))},dismissNotice:function(e){e.preventDefault(),a(e.currentTarget).closest(".notice-success").hide(),a.post(zvc_ajax.ajaxurl,{action:"zoom_dimiss_notice"}).done(function(e){console.log(e)})},checkConnection:function(e){e.preventDefault(),s.cover.show(),a.post(zvc_ajax.ajaxurl,{action:"check_connection",security:zvc_ajax.zvc_security}).done(function(e){s.cover.hide(),alert(e)})},meetingStateChange:function(e){e.preventDefault();var t=a(e.currentTarget).data("state"),i=a(e.currentTarget).data("postid"),n={id:a(e.currentTarget).data("id"),state:t,type:a(e.currentTarget).data("type"),post_id:i||!1,action:"state_change",accss:zvc_ajax.zvc_security};if("resume"===t)this.changeState(n);else if("end"===t){if(!confirm(zvc_ajax.lang.confirm_end))return;this.changeState(n)}},changeState:function(e){a.post(zvc_ajax.ajaxurl,e).done(function(e){location.reload()})}};a(function(){e.onReady()})}(jQuery);